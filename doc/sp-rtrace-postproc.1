.TH SP-RTRACE-POSTPROC 1 "2010-07-1" "sp-rtrace-postproc"
.SH NAME
sp-rtrace-postproc - resource consumption trace data processor
.SH SYNOPSIS
sp-rtrace-postproc \fI<options>\fP
.SH DESCRIPTION
sp-rtrace-postproc is a resource consumption trace data post-processor.
It accepts binary data generated by the pre-processor, text data
written by it itself or by the resolver, applies the specified
post-processing options on that and generates text format output.
.SS Options:
.TP 
 \fI--help\fP (\fI-h\fP)
Displays help information and exits.
.TP
\fI--output-dir\fP=<path> (\fI-o\fP <path)
Specifies the output directory for storing processed trace data. 

By default the data is written to the standard output.

.TP
\fI--input-file\fP=<path> (\fI-i\fP <path>)
Specifies the input file.

By default the data is read from the standard input.
.TP
\fI--text\fP (\fI-t\fP)
An optional switch to write output in text format. As the output is 
always written in text format, this switch does nothing.

The only time when it should be used is when user wants to invoke
postprocessor from sp-rtrace without any post-processing options 
(just to convert the binary log into text format):

sp-rtrace -pmemory -s -P -t -x <app>
.TP
\fI--filter-leaks\fP (\fI-l\fP)
Filters leaked resources by removing allocations of the resources that
are freed afterwards. The deallocation call records are also removed.
This option leaves only leaked (non-freed) resource allocations in trace
file.
.TP
\fI--compress\fP (\fI-c\fP)
Compresses trace data by grouping function calls with the same backtraces.
In combination with \fI--filter-leaks\fP option it gives better view of 
the leak sources by combining leaked resources with the same origins.
.TP
\fI--resolve\fP (\fI-r\fP)
Resolves backtrace addresses by starting sp-rtrace-resolve process and
redirecting output to it. If --output-dir option is set, post-processor
generates appropriate output file name and passes it to the resolver with 
-o option. Otherwise the resolved data will be written to standard output.

The resolver is launched with full caching mode and elf resolving method 
enabled. To use other resolving options the resolver must be used separately.
.TP
\fI--context\fP=<mask> (\fI-C\fP <mask>)
Filters function call records matching the specified context id mask.
.TP
\fI--resource\fP=<mask> (\fI-R\fP <mask>)
Filters function call records matching the specified resource type mask.
.TP
\fI--sort\fP=<order> (\fI-s\fP <order>)
Sets the backtrace sorting order for --compress and --filter-leaks 
options. Where <order> can be:
  size      - sort by a total leak size of a backtrace
              in descending order.  
  size-asc  - sort by a total leak size of a backtrace 
              in ascending order.
  count     - sort by a total leak count of a backtrace 
              in descending order.
  count-asc - sort by a total leak count of a backtrace
              in ascending order.

By default the backtraces are sorted by a total leak size 
in descending order.
.TP
\fI--backtrace-depth\fP=<max_depth> (\fI-b\fP <max_depth>)
Sets maximum backtrace depth. Any function stack traces larger
than \fImax_depth\fP value will be trimmed to the \fImax_depth\fP
value.
.TP
\fI--include\fP=<file>
Removes events that aren't listed in the \fIfile\fP. The include file
is in text format and contains one event index per line.
.TP
\fI--exclude\fP=<file>
Removes events that are listed in the \fIfile\fP. The exclude file
is in text format and contains one event index per line.
.TP
\fI--call-address\fP=<target>:<start address>+<size>
Removes allocation events not originated from the specified code
range. 

This option is usefull to monitor only allocations from a
specific address range, for example a library function.
This option is best used with helper script sp-rtrace-function-address
which extracts function address range from target binary and displayes
it in the --call-address option format:
sp-rtrace-function-address <target> <function>


For example:
sp-rtrace-postproc -i <input report> --call-addresss=$(sp-rtrace-function-address <library> <function>) -lr


.TP
\fI--quiet\fP (\fI-q\fP)
Suppress warning messages. Note that command line parsing warnings
are not suppressed for options specified before this option.

.SH EXAMPLES
.TP
sp-rtrace-postproc -i rtrace-raw-2535 > rtrace-text
Convert the binary data file rtrace-raw-2535 into text format and write
the result into rtrace-text.
.TP
sp-rtrace-postproc -i rtrace-text -l -f text > rtrace-text-leaks
Filter leaks from the text data in rtrace-text and store the result into
rtrace-text-leaks file.
.TP
sp-rtrace-postproc -i rtrace-text-leaks -c -r -f text > rtrace-text-resolved
Compress backtraces, resolve addresses and store the result into
rtrace-text-resolved file.

.SH SEE ALSO
.IR sp-rtrace (1),
.IR sp-rtrace-resolve (1)
.SH COPYRIGHT
Copyright (C) 2010 Nokia Corporation.
.PP
This is free software. You may redistribute copies of it under the
terms of the GNU General Public License v2 included with the software.
There is NO WARRANTY, to the extent permitted by law.
